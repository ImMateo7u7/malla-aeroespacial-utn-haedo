<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <title>Malla Curricular - Ing. Aeroespacial UTN Haedo</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />

  <style>
    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
    }

    body {
      background: #0b1020;
      color: #f5f5f5;
      padding: 20px;
    }

    h1 {
      text-align: center;
      margin-bottom: 10px;
    }

    .subtitulo {
      text-align: center;
      margin-bottom: 25px;
      color: #c5c5c5;
      font-size: 0.95rem;
    }

    .layout {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
      gap: 18px;
      max-width: 1200px;
      margin: 0 auto;
    }

    .anio {
      background: #151a2e;
      border-radius: 14px;
      padding: 14px;
      border: 1px solid #242b46;
    }

    .anio h2 {
      font-size: 1.1rem;
      margin-bottom: 8px;
    }

    .anio small {
      color: #9ba0bc;
      font-size: 0.8rem;
    }

    .materias {
      margin-top: 10px;
      display: flex;
      flex-direction: column;
      gap: 6px;
    }

    .materia {
      padding: 6px 8px;
      border-radius: 10px;
      font-size: 0.88rem;
      border: 1px solid #262b42;
      display: flex;
      justify-content: space-between;
      align-items: center;
      transition: 0.15s ease;
    }

    .materia span.nombre {
      max-width: 75%;
    }

    .materia:not(.bloqueada) {
      cursor: pointer;
    }

    .tag {
      padding: 2px 8px;
      border-radius: 999px;
      font-size: 0.7rem;
      border: 1px solid transparent;
      white-space: nowrap;
    }

    /* Estados */
    .aprobada {
      background: #102818;
      border-color: #2b5a35;
    }
    .aprobada .tag {
      background: #39c16a22;
      border-color: #39c16a;
      color: #a4ffbf;
    }

    .cursando {
      background: #102332;
      border-color: #265784;
    }
    .cursando .tag {
      background: #3b82f622;
      border-color: #3b82f6;
      color: #c3ddff;
    }

    .pendiente {
      background: #191b28;
      border-color: #2a3046;
    }
    .pendiente .tag {
      background: #4b556322;
      border-color: #4b5563;
      color: #e5e7eb;
    }

    /* Bloqueada por correlativas */
    .bloqueada {
      opacity: 0.35;
      filter: grayscale(0.4);
      cursor: not-allowed !important;
    }

    /* Leyenda */
    .leyenda {
      max-width: 500px;
      margin: 0 auto 20px auto;
      display: flex;
      justify-content: center;
      gap: 10px;
      flex-wrap: wrap;
      font-size: 0.8rem;
    }
    .leyenda-item {
      display: inline-flex;
      align-items: center;
      gap: 5px;
    }
    .leyenda-color {
      width: 14px;
      height: 14px;
      border-radius: 4px;
      border: 1px solid #4b5563;
    }
    .leyenda-aprobada { background: #2b5a35; }
    .leyenda-cursando { background: #265784; }
    .leyenda-pendiente { background: #191b28; }
  </style>
</head>

<body>
  <h1>üõ†Ô∏è Malla Curricular - Ing. Aeroespacial</h1>
  <p class="subtitulo">
    UTN Haedo ¬∑ Plan 2023 (seguimiento interactivo de materias)
  </p>

  <div class="leyenda">
    <div class="leyenda-item">
      <div class="leyenda-color leyenda-aprobada"></div> Aprobada
    </div>
    <div class="leyenda-item">
      <div class="leyenda-color leyenda-cursando"></div> En curso
    </div>
    <div class="leyenda-item">
      <div class="leyenda-color leyenda-pendiente"></div> Pendiente / Bloqueada
    </div>
  </div>

  <main class="layout">
    <!-- 1¬∫ A√±o -->
    <section class="anio">
      <h2>1¬∫ A√±o</h2>
      <small>Fundamentos</small>
      <div class="materias">
        <!-- Sin correlativas: data-req="" -->
        <div class="materia aprobada" data-id="SRI" data-req="">
          <span class="nombre">Sistemas de Representaci√≥n en Ingenier√≠a</span>
          <span class="tag">Aprobada (9)</span>
        </div>
        <div class="materia aprobada" data-id="ALG" data-req="">
          <span class="nombre">√Ålgebra y Geometr√≠a Anal√≠tica</span>
          <span class="tag">Aprobada (7)</span>
        </div>
        <div class="materia cursando" data-id="AMI" data-req="">
          <span class="nombre">An√°lisis Matem√°tico I</span>
          <span class="tag">En curso</span>
        </div>
        <div class="materia aprobada" data-id="FIS1" data-req="">
          <span class="nombre">F√≠sica I</span>
          <span class="tag">Aprobada (8)</span>
        </div>
        <div class="materia aprobada" data-id="QUI" data-req="">
          <span class="nombre">Qu√≠mica General</span>
          <span class="tag">Aprobada (10)</span>
        </div>
        <div class="materia aprobada" data-id="ING1" data-req="">
          <span class="nombre">Ingl√©s I</span>
          <span class="tag">Aprobada (6)</span>
        </div>
        <div class="materia cursando" data-id="IYS" data-req="">
          <span class="nombre">Ingenier√≠a y Sociedad</span>
          <span class="tag">En curso</span>
        </div>
        <div class="materia cursando" data-id="CAE1" data-req="">
          <span class="nombre">Conocimientos Aeron√°uticos y Espaciales I</span>
          <span class="tag">En curso</span>
        </div>
        <div class="materia pendiente" data-id="DRA" data-req="">
          <span class="nombre">Dise√±o y Representaci√≥n Aeroespacial</span>
          <span class="tag">Pendiente</span>
        </div>
      </div>
    </section>

    <!-- 2¬∫ A√±o -->
    <section class="anio">
      <h2>2¬∫ A√±o</h2>
      <small>Base cient√≠fica y num√©rica</small>
      <div class="materias">
        <!-- Ejemplo: An√°lisis II requiere An√°lisis I aprobado -->
        <div class="materia pendiente" data-id="AMII" data-req="AMI">
          <span class="nombre">An√°lisis Matem√°tico II</span>
          <span class="tag">Pendiente</span>
        </div>
        <!-- F√≠sica II requiere FIS1 + AMI, por ejemplo -->
        <div class="materia pendiente bloqueada" data-id="FIS2" data-req="FIS1,AMI">
          <span class="nombre">F√≠sica II</span>
          <span class="tag">Pendiente</span>
        </div>
        <div class="materia pendiente bloqueada" data-id="TMF" data-req="AMI">
          <span class="nombre">Termodin√°mica y Mec√°nica de Fluidos</span>
          <span class="tag">Pendiente</span>
        </div>
        <div class="materia pendiente bloqueada" data-id="MAT_AERO" data-req="QUI">
          <span class="nombre">Materiales Aeroespaciales</span>
          <span class="tag">Pendiente</span>
        </div>
        <div class="materia pendiente bloqueada" data-id="CALC_NUM" data-req="AMI">
          <span class="nombre">C√°lculo Num√©rico</span>
          <span class="tag">Pendiente</span>
        </div>
        <div class="materia pendiente bloqueada" data-id="ING2" data-req="ING1">
          <span class="nombre">Ingl√©s II</span>
          <span class="tag">Pendiente</span>
        </div>
      </div>
    </section>

    <!-- 3¬∫ A√±o -->
    <section class="anio">
      <h2>3¬∫ A√±o</h2>
      <small>N√∫cleo aeroespacial</small>
      <div class="materias">
        <div class="materia pendiente bloqueada" data-id="AERO1" data-req="TMF,CALC_NUM">
          <span class="nombre">(Completar con tu plan)</span>
          <span class="tag">Pendiente</span>
        </div>
      </div>
    </section>

    <!-- 4¬∫ A√±o -->
    <section class="anio">
      <h2>4¬∫ A√±o</h2>
      <small>Proyecto y dise√±o</small>
      <div class="materias">
        <div class="materia pendiente bloqueada" data-id="AERO2" data-req="AERO1">
          <span class="nombre">(Completar con tu plan)</span>
          <span class="tag">Pendiente</span>
        </div>
      </div>
    </section>

    <!-- 5¬∫ A√±o -->
    <section class="anio">
      <h2>5¬∫ A√±o</h2>
      <small>Integraci√≥n y cierre</small>
      <div class="materias">
        <div class="materia pendiente bloqueada" data-id="TFI" data-req="AERO2">
          <span class="nombre">Trabajo Final / Proyecto Final</span>
          <span class="tag">Pendiente</span>
        </div>
      </div>
    </section>
  </main>

  <!-- üß† L√≥gica interactiva -->
  <script>
    const materias = document.querySelectorAll(".materia");
    let estado = JSON.parse(localStorage.getItem("mallaEstado") || "{}");

    function setEstado(elem, nuevoEstado, guardar = true) {
      elem.classList.remove("aprobada", "cursando", "pendiente");
      elem.classList.add(nuevoEstado);

      const tag = elem.querySelector(".tag");
      if (nuevoEstado === "aprobada") tag.textContent = "Aprobada";
      else if (nuevoEstado === "cursando") tag.textContent = "En curso";
      else tag.textContent = "Pendiente";

      if (guardar) {
        estado[elem.dataset.id] = nuevoEstado;
        localStorage.setItem("mallaEstado", JSON.stringify(estado));
      }
    }

    function actualizarBloqueos() {
      materias.forEach((m) => {
        const reqStr = m.dataset.req || "";
        const reqs = reqStr.split(",").map(r => r.trim()).filter(Boolean);

        if (reqs.length === 0) {
          m.classList.remove("bloqueada");
          return;
        }

        const habilitada = reqs.every((id) => estado[id] === "aprobada");
        if (habilitada) {
          m.classList.remove("bloqueada");
        } else {
          m.classList.add("bloqueada");
        }
      });
    }

    function aplicarEstadoInicial() {
      materias.forEach((m) => {
        const id = m.dataset.id;
        const stGuardado = estado[id];
        if (stGuardado) {
          setEstado(m, stGuardado, false);
        } else {
          // si no hay guardado, tomamos el que tenga en el HTML
          if (m.classList.contains("aprobada")) estado[id] = "aprobada";
          else if (m.classList.contains("cursando")) estado[id] = "cursando";
          else estado[id] = "pendiente";
        }
      });
      localStorage.setItem("mallaEstado", JSON.stringify(estado));
      actualizarBloqueos();
    }

    materias.forEach((m) => {
      m.addEventListener("click", () => {
        if (m.classList.contains("bloqueada")) return;

        const id = m.dataset.id;
        const actual = estado[id] || "pendiente";
        let siguiente;
        if (actual === "pendiente") siguiente = "cursando";
        else if (actual === "cursando") siguiente = "aprobada";
        else siguiente = "pendiente";

        setEstado(m, siguiente);
        actualizarBloqueos();
      });
    });

    aplicarEstadoInicial();
  </script>
</body>
</html>
